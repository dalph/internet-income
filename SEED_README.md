# Сидеры для тестовых данных

Этот документ описывает использование сидеров для заполнения базы данных тестовыми данными.

## Доступные команды

### Полное сидирование
Запускает создание всех тестовых данных (пользователи, категории, ссылки):
```bash
make seed
```

### Выборочное сидирование

#### Пользователи
Создает тестовых пользователей:
```bash
make seed-users
```

Создаваемые пользователи:
- `admin` / `admin123` - администратор (активен)
- `user1` / `user123` - обычный пользователь (активен)
- `user2` / `user123` - обычный пользователь (неактивен)
- `moderator` / `mod123` - модератор (активен)

#### Категории реферальных ссылок
Создает тестовые категории:
```bash
make seed-categories
```

Создаваемые категории:
- Криптовалюты (активна, приоритет 1)
- Форекс (активна, приоритет 2)
- Бинарные опционы (активна, приоритет 3)
- Букмекеры (активна, приоритет 4)
- Казино (неактивна, приоритет 5)

#### Реферальные ссылки
Создает тестовые реферальные ссылки:
```bash
make seed-links
```

Создаваемые ссылки:
- **Криптовалюты:**
  - Binance (топовая, активна)
  - Bybit (топовая, активна)
  - OKX (обычная, активна)

- **Форекс:**
  - Alpari (топовая, активна)
  - Forex4you (обычная, активна)

- **Бинарные опционы:**
  - IQ Option (топовая, активна)
  - Binary.com (обычная, неактивна)

- **Букмекеры:**
  - 1xBet (топовая, активна)
  - Bet365 (обычная, активна)

### Очистка данных
Удаляет все тестовые данные (кроме пользователя admin):
```bash
make seed-clear
```



## Прямые команды Yii

Если нужно запустить команды напрямую через Yii:

```bash
# Полное сидирование
docker-compose -f docker-compose.yml exec app php yii seed

# Только пользователи
docker-compose -f docker-compose.yml exec app php yii seed/users

# Только категории
docker-compose -f docker-compose.yml exec app php yii seed/categories

# Только ссылки
docker-compose -f docker-compose.yml exec app php yii seed/links

# Очистка
docker-compose -f docker-compose.yml exec app php yii seed/clear



## Особенности

1. **Проверка существования**: Сидеры проверяют существование записей перед созданием, чтобы избежать дублирования.

2. **Связи между данными**: Реферальные ссылки автоматически привязываются к соответствующим категориям.

3. **Безопасность**: Команда очистки не удаляет пользователя `admin`, чтобы сохранить доступ к системе.

4. **Логирование**: Все операции логируются с цветным выводом для удобства отслеживания.

## Использование в разработке

Рекомендуется использовать сидеры для:
- Быстрого заполнения базы данных тестовыми данными
- Демонстрации функциональности
- Тестирования интерфейса с реальными данными
- Подготовки демо-версии приложения

## Структура данных

### Пользователи
- Поддерживаются статусы: активен, неактивен, удален
- Автоматически генерируются auth_key и хеши паролей
- Устанавливаются временные метки создания и обновления

### Категории
- Имеют название, описание, статус и приоритет
- Поддерживаются статусы: активна, неактивна
- Сортировка по приоритету

### Реферальные ссылки
- Связаны с категориями через внешний ключ
- Имеют статус активности и флаг "топовая ссылка"
- Поддерживают приоритет для сортировки
- Валидируются URL-адреса 